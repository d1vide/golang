# Практическое занятие №9

## Тема: Реализация регистрации и входа пользователей. Хэширование паролей с bcrypt

**Студент:** Наумов А.Е.
**Группа:** ЭФМО-01-25


## Подготовка окружения

Контейнер с Postgres
```bash
docker run -d \
  --name postgres-go \
  -e POSTGRES_PASSWORD=password \
  -e POSTGRES_USER=user \
  -e POSTGRES_DB=todo \
  -p 5433:5432 \
  -v postgres-data2:/var/lib/postgresql/data \
  postgres
```

Переменные окружения
```bash
export DB_DSN=postgres://user:password@localhost:5433/todo?sslmode=disable
```

## Примеры запросов

- Успешная регистрация

![alt text](screenshots/image.png)

- Повторная попытка

![alt text](screenshots/image-1.png)

- Вход с верными данными

![alt text](screenshots/image-2.png)

- Вход с неверными данными 

![alt text](screenshots/image-3.png)

### Фрагменты кода
bcrypt.GenerateFromPassword (генерация хэша)

![alt text](screenshots/image-4.png)

bcrypt.CompareHashAndPassword (сравнение хэша из бд с полученным паролем)

![alt text](screenshots/image-5.png)

### Почему нельзя хранить пароли в открытом виде:
1. Полная компрометация при утечке БД
Если злоумышленник получит доступ к базе данных, он сразу получит все пароли пользователей. Это даст ему доступ ко всем аккаунтам без необходимости взламывать пароли.

2. Межсервисная уязвимость
Пользователи часто используют одинаковые пароли на разных сервисах. Если пароль утек с одного сервиса, злоумышленник может получить доступ к аккаунтам пользователей на других платформах (почта, банки, соцсети).


###  Почему bcrypt
1. Защита от быстрого перебора (brute force)
MD5, SHA-1, SHA-256 очень быстрые - можно вычислять миллионы хэшей в секунду
bcrypt имеет регулируемую сложность (параметр cost). Чем выше cost, тем больше времени требуется на вычисление хэша. Типичные значения 10-14 дают время вычисления ~100-500мс

2. Встроенная соль (random seed)
Без соли одинаковые пароли дают одинаковые хэши. Можно использовать rainbow tables для быстрого взлома
bcrypt автоматически генерирует случайную соль для каждого пароля. Даже одинаковые пароли дают разные хэши